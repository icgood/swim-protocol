


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>swimprotocol.udp &#8212; swim-protocol 0.3.7 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/cloud.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>

    
    
     
        <script src="_static/jquery.cookie.js"></script>
    

    
     
        <script src="_static/cloud.base.js"></script>
    

    
     
        <script src="_static/cloud.js"></script>
    

    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="swimprotocol" href="swimprotocol.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="swimprotocol.html" title="swimprotocol"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="index.html">swim-protocol 0.3.7 documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href=""><code class="docutils literal notranslate"><span class="pre">swimprotocol.udp</span></code></a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-swimprotocol.udp">
<span id="swimprotocol-udp"></span><h1><code class="docutils literal notranslate"><span class="pre">swimprotocol.udp</span></code><a class="headerlink" href="#module-swimprotocol.udp" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="swimprotocol.udp.UdpConfig">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">swimprotocol.udp.</span></span><span class="sig-name descname"><span class="pre">UdpConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bind_host</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bind_port</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_host</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_port</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discovery</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swimprotocol.udp.UdpConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="swimprotocol.html#swimprotocol.config.BaseConfig" title="swimprotocol.config.BaseConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">swimprotocol.config.BaseConfig</span></code></a></p>
<p>Implements <a class="reference internal" href="swimprotocol.html#swimprotocol.config.BaseConfig" title="swimprotocol.config.BaseConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseConfig</span></code></a>, adding additional
configuration required for <a class="reference internal" href="#swimprotocol.udp.UdpTransport" title="swimprotocol.udp.UdpTransport"><code class="xref py py-class docutils literal notranslate"><span class="pre">UdpTransport</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bind_host</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – The hostname or IP address to bind the UDP socket. The
hostname from the <em>local_name</em> address is used by default.</p></li>
<li><p><strong>bind_port</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – The port number to bind the UDP socket. The port from the
<em>local_name</em> address is used by default.</p></li>
<li><p><strong>default_host</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – The hostname or IP address to connect to if an address
string does not specify a hostname, e.g. <code class="docutils literal notranslate"><span class="pre">':1234'</span></code>.</p></li>
<li><p><strong>default_port</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – The port number to connect to if an address string does
not specify a port number, e.g. <code class="docutils literal notranslate"><span class="pre">'myhost'</span></code>.</p></li>
<li><p><strong>discovery</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Resolve the local address as a DNS <strong>A</strong>/<strong>AAAA</strong> record
containing peers. The local IP address will also be auto-discovered
by attempting to <a class="reference external" href="https://docs.python.org/3/library/socket.html#socket.socket.connect" title="(in Python v3.9)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">connect()</span></code></a> to the hostname.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>) – Additional keyword arguments passed to the
<a class="reference internal" href="swimprotocol.html#swimprotocol.config.BaseConfig" title="swimprotocol.config.BaseConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseConfig</span></code></a> constructor.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="swimprotocol.udp.UdpConfig.add_arguments">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">add_arguments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'--'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swimprotocol.udp.UdpConfig.add_arguments" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementations (such as the <a class="reference internal" href="intro.html#term-demo"><span class="xref std std-term">demo</span></a>) may use this method to
add command-line based configuration for the transport.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Arguments added should use <em>prefix</em> and explicitly provide a unique
name, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">arg&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;swim_arg&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>This prevents collision with other argument names and allows custom
<em>prefix</em> values without affecting the <a class="reference external" href="https://docs.python.org/3/library/argparse.html#argparse.Namespace" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Namespace</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parser</strong> (<a class="reference external" href="https://docs.python.org/3/library/argparse.html#argparse.ArgumentParser" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArgumentParser</span></code></a>) – The argument parser.</p></li>
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – The prefix for added arguments, which should start with
<code class="docutils literal notranslate"><span class="pre">--</span></code> and end with <code class="docutils literal notranslate"><span class="pre">-</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">'--'</span></code> or <code class="docutils literal notranslate"><span class="pre">'--foo-'</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swimprotocol.udp.UdpConfig.parse_args">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">parse_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SWIM'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swimprotocol.udp.UdpConfig.parse_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the given <a class="reference external" href="https://docs.python.org/3/library/argparse.html#argparse.Namespace" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Namespace</span></code></a> into a dictionary of
keyword arguments for the <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseConfig</span></code> constructor. Sub-classes
should override this method to add additional keyword arguments as
needed.</p>
<p>Some keywords will default to environment variables if not given in
<em>args</em>:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">SWIM_SECRET</span></code>, <code class="docutils literal notranslate"><span class="pre">SWIM_SECRET_FILE</span></code> <a class="footnote-reference brackets" href="#id2" id="id1">*</a></dt><dd><p>The <em>secret</em> keyword argument.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">SWIM_NAME</span></code></dt><dd><p>The <em>local_name</em> keyword argument.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">SWIM_PEERS</span></code></dt><dd><p>The comma-separated <em>peers</em> keyword argument.</p>
</dd>
</dl>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">*</a></span></dt>
<dd><p>The value is read from the given file path.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/argparse.html#argparse.Namespace" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Namespace</span></code></a>) – The command-line arguments.</p></li>
<li><p><strong>env_prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Prefix for the environment variables.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="swimprotocol.udp.UdpTransport">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">swimprotocol.udp.</span></span><span class="sig-name descname"><span class="pre">UdpTransport</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swimprotocol.udp.UdpTransport" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="swimprotocol.html#swimprotocol.transport.Transport" title="swimprotocol.transport.Transport"><code class="xref py py-class docutils literal notranslate"><span class="pre">swimprotocol.transport.Transport</span></code></a>[<a class="reference internal" href="#swimprotocol.udp.UdpConfig" title="swimprotocol.udp.UdpConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">swimprotocol.udp.UdpConfig</span></code></a>]</p>
<p>Implements <a class="reference internal" href="swimprotocol.html#swimprotocol.transport.Transport" title="swimprotocol.transport.Transport"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transport</span></code></a> using UDP, without
<a class="reference external" href="https://en.wikipedia.org/wiki/Broadcast_address">broadcast</a>.</p>
<p>This transport assumes that the name of each cluster member is in
<code class="docutils literal notranslate"><span class="pre">host:port</span></code> format, and that any cluster member can receive UDP packets
from any other cluster member.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference internal" href="#swimprotocol.udp.UdpConfig" title="swimprotocol.udp.UdpConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">UdpConfig</span></code></a>) – The cluster configuration object.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="swimprotocol.udp.UdpTransport.config_type">
<span class="sig-name descname"><span class="pre">config_type</span></span><a class="headerlink" href="#swimprotocol.udp.UdpTransport.config_type" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#swimprotocol.udp.UdpConfig" title="swimprotocol.udp.UdpConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">swimprotocol.udp.UdpConfig</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swimprotocol.udp.UdpTransport.bind_host">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">bind_host</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#swimprotocol.udp.UdpTransport.bind_host" title="Permalink to this definition">¶</a></dt>
<dd><p>The local bind address used to open the UDP socket to receive
packets.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.loop.create_datagram_endpoint()</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="swimprotocol.udp.UdpTransport.bind_port">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">bind_port</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#swimprotocol.udp.UdpTransport.bind_port" title="Permalink to this definition">¶</a></dt>
<dd><p>The local bind port used to open the UDP socket to receive packets.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.loop.create_datagram_endpoint()</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swimprotocol.udp.UdpTransport.enter">
<span class="sig-name descname"><span class="pre">enter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">members</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swimprotocol.udp.UdpTransport.enter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an async context manager that, when entered, provides a
<a class="reference internal" href="swimprotocol.html#swimprotocol.worker.Worker" title="swimprotocol.worker.Worker"><code class="xref py py-class docutils literal notranslate"><span class="pre">Worker</span></code></a> instance that uses the transport
for transmitting and receiving SWIM protocol packets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>members</strong> (<a class="reference internal" href="swimprotocol.html#swimprotocol.members.Members" title="swimprotocol.members.Members"><code class="xref py py-class docutils literal notranslate"><span class="pre">Members</span></code></a>) – Tracks the state of the cluster members.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.AsyncIterator" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncIterator</span></code></a>[<a class="reference internal" href="swimprotocol.html#swimprotocol.worker.Worker" title="swimprotocol.worker.Worker"><code class="xref py py-class docutils literal notranslate"><span class="pre">Worker</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="docker-services">
<h2>Docker Services<a class="headerlink" href="#docker-services" title="Permalink to this headline">¶</a></h2>
<p>If your application is deployed as a <a class="reference external" href="https://docs.docker.com/engine/swarm/how-swarm-mode-works/services/">Docker Service</a>, the
<a class="reference internal" href="#swimprotocol.udp.UdpConfig" title="swimprotocol.udp.UdpConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">UdpConfig</span></code></a> <code class="docutils literal notranslate"><span class="pre">discovery=True</span></code> keyword argument can be
used to discover configuration based on the service name. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="n">UdpConfig</span><span class="p">(</span><span class="n">local_name</span><span class="o">=</span><span class="s1">&#39;tasks.my-service:9999&#39;</span><span class="p">,</span> <span class="n">discovery</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Docker provides a <a class="reference external" href="https://docs.docker.com/network/overlay/#container-discovery">tasks</a> DNS lookup that resolves to the IP addresses of all
replicas of the service. In this example, <code class="docutils literal notranslate"><span class="pre">tasks.my-service</span></code> is resolved to
these IP addresses. The IP address local to the container is chosen as the
<a class="reference internal" href="intro.html#term-local-member"><span class="xref std std-term">local member</span></a> and the rest are <a class="reference internal" href="intro.html#term-peer-member"><span class="xref std std-term">peer members</span></a>.</p>
<p>In practice, this DNS lookup is often not immediately successful when the
replicas start up. A service may also be scaled down to a single replica, which
has no need of a cluster. These scenarios will raise a
<a class="reference internal" href="swimprotocol.html#swimprotocol.config.TransientConfigError" title="swimprotocol.config.TransientConfigError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TransientConfigError</span></code></a> with a <em>wait_hint</em> value. This
exception can be caught to continuously retry the cluster configuration until
successful:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">start</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">UdpConfig</span><span class="p">(</span><span class="n">local_name</span><span class="o">=</span><span class="s1">&#39;tasks.my-service:9999&#39;</span><span class="p">,</span>
                               <span class="n">discovery</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">TransientConfigError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">wait_hint</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="c1"># ...</span>
</pre></div>
</div>
</section>
<section id="module-swimprotocol.udp.pack">
<span id="swimprotocol-udp-pack"></span><h2><code class="docutils literal notranslate"><span class="pre">swimprotocol.udp.pack</span></code><a class="headerlink" href="#module-swimprotocol.udp.pack" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swimprotocol.udp.pack.UdpPack">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">swimprotocol.udp.pack.</span></span><span class="sig-name descname"><span class="pre">UdpPack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signatures</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pickle_protocol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix_xor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">b'SWIM'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swimprotocol.udp.pack.UdpPack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Packs and unpacks SWIM protocol <a class="reference internal" href="swimprotocol.html#swimprotocol.packet.Packet" title="swimprotocol.packet.Packet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Packet</span></code></a>
objects from raw UDP packets. The <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.9)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a> module is used for
serialization, so <a class="reference internal" href="swimprotocol.html#swimprotocol.sign.Signatures" title="swimprotocol.sign.Signatures"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signatures</span></code></a> is used to sign
the payloads.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signatures</strong> (<a class="reference internal" href="swimprotocol.html#swimprotocol.sign.Signatures" title="swimprotocol.sign.Signatures"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signatures</span></code></a>) – Generates and verifies cluster packet signatures.</p></li>
<li><p><strong>pickle_protocol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – The <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.9)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a> protocol version number.</p></li>
<li><p><strong>prefix_xor</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>) – A 4-byte string used to XOR the packet prefix, as a sanity
check to detect malformed or incomplete UDP packets.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="swimprotocol.udp.pack.UdpPack.pack">
<span class="sig-name descname"><span class="pre">pack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">packet</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swimprotocol.udp.pack.UdpPack.pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.9)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a> to serialize <em>packet</em>, generates a digital
signature of the pickled data, and returns a byte-string that can be
sent as a raw UDP packet.</p>
<p>The resulting byte-string starts with a 4-byte <a class="reference external" href="https://docs.python.org/3/library/struct.html#module-struct" title="(in Python v3.9)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">struct</span></code></a> prefix
(XOR’ed with <em>prefix_xor</em>) with the <a class="reference external" href="https://docs.python.org/3/library/struct.html#format-strings">struct format</a>
<code class="docutils literal notranslate"><span class="pre">!BBH</span></code>. The first byte is the length of the salt, the second byte is
the length of the signature, and the final two bytes are the length of
the pickled payload. After the prefix, the salt, digest, and pickled
payload byte-strings are concatenated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>packet</strong> (<a class="reference internal" href="swimprotocol.html#swimprotocol.packet.Packet" title="swimprotocol.packet.Packet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Packet</span></code></a>) – The SWIM protocol packet to serialize.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swimprotocol.udp.pack.UdpPack.unpack">
<span class="sig-name descname"><span class="pre">unpack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swimprotocol.udp.pack.UdpPack.unpack" title="Permalink to this definition">¶</a></dt>
<dd><p>Deserializes a byte-string that was created using <a class="reference internal" href="#swimprotocol.udp.pack.UdpPack.pack" title="swimprotocol.udp.pack.UdpPack.pack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pack()</span></code></a> into
a SWIM protocol packet. If any assumptions about the serialized data
are not met, including an invalid signature, <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned to
indicate that <em>data</em> was malformed or incomplete.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>) – The serialized byte-string of the SWIM protocol packet.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="swimprotocol.html#swimprotocol.packet.Packet" title="swimprotocol.packet.Packet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Packet</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-swimprotocol.udp.protocol">
<span id="swimprotocol-udp-protocol"></span><h2><code class="docutils literal notranslate"><span class="pre">swimprotocol.udp.protocol</span></code><a class="headerlink" href="#module-swimprotocol.udp.protocol" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="swimprotocol.udp.protocol.SwimProtocol">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">swimprotocol.udp.protocol.</span></span><span class="sig-name descname"><span class="pre">SwimProtocol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">address_parser</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">udp_pack</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swimprotocol.udp.protocol.SwimProtocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.protocols.DatagramProtocol</span></code>, <a class="reference internal" href="swimprotocol.html#swimprotocol.worker.IO" title="swimprotocol.worker.IO"><code class="xref py py-class docutils literal notranslate"><span class="pre">swimprotocol.worker.IO</span></code></a></p>
<p>Implements <a class="reference external" href="https://docs.python.org/3/library/asyncio-protocol.html#asyncio.DatagramProtocol" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatagramProtocol</span></code></a> and
<a class="reference internal" href="swimprotocol.html#swimprotocol.worker.IO" title="swimprotocol.worker.IO"><code class="xref py py-class docutils literal notranslate"><span class="pre">IO</span></code></a> to send and receive UDP as SWIM protocol
packets.</p>
<dl class="py property">
<dt class="sig sig-object py" id="swimprotocol.udp.protocol.SwimProtocol.transport">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">transport</span></span><em class="property"><span class="pre">:</span> <span class="pre">asyncio.transports.DatagramTransport</span></em><a class="headerlink" href="#swimprotocol.udp.protocol.SwimProtocol.transport" title="Permalink to this definition">¶</a></dt>
<dd><p>The current <a class="reference external" href="https://docs.python.org/3/library/asyncio-protocol.html#asyncio.DatagramTransport" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatagramTransport</span></code></a> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DatagramTransport</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swimprotocol.udp.protocol.SwimProtocol.connection_made">
<span class="sig-name descname"><span class="pre">connection_made</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transport</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swimprotocol.udp.protocol.SwimProtocol.connection_made" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when the UDP socket is initialized.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://docs.python.org/3/library/asyncio-protocol.html#asyncio.BaseProtocol.connection_made" title="(in Python v3.9)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asyncio.BaseProtocol.connection_made()</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swimprotocol.udp.protocol.SwimProtocol.datagram_received">
<span class="sig-name descname"><span class="pre">datagram_received</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swimprotocol.udp.protocol.SwimProtocol.datagram_received" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when data is received on the UDP socket.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://docs.python.org/3/library/asyncio-protocol.html#asyncio.DatagramProtocol.datagram_received" title="(in Python v3.9)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asyncio.DatagramProtocol.datagram_received()</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swimprotocol.udp.protocol.SwimProtocol.recv">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">recv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swimprotocol.udp.protocol.SwimProtocol.recv" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait until a packet has been received by the transport layer and
return it.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="swimprotocol.html#swimprotocol.packet.Packet" title="swimprotocol.packet.Packet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Packet</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="swimprotocol.udp.protocol.SwimProtocol.send">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">send</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">member</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">packet</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#swimprotocol.udp.protocol.SwimProtocol.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Send the given <em>packet</em> to another cluster <em>member</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>member</strong> (<a class="reference internal" href="swimprotocol.html#swimprotocol.members.Member" title="swimprotocol.members.Member"><code class="xref py py-class docutils literal notranslate"><span class="pre">Member</span></code></a>) – The recipient cluster member.</p></li>
<li><p><strong>packet</strong> (<a class="reference internal" href="swimprotocol.html#swimprotocol.packet.Packet" title="swimprotocol.packet.Packet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Packet</span></code></a>) – The SWIM protocol packet to send.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="index.html">Page contents</a></h3>
    <ul>
<li><a class="reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">swimprotocol.udp</span></code></a><ul>
<li><a class="reference internal" href="#docker-services">Docker Services</a></li>
<li><a class="reference internal" href="#module-swimprotocol.udp.pack"><code class="docutils literal notranslate"><span class="pre">swimprotocol.udp.pack</span></code></a></li>
<li><a class="reference internal" href="#module-swimprotocol.udp.protocol"><code class="docutils literal notranslate"><span class="pre">swimprotocol.udp.protocol</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="swimprotocol.html"
                          title="Previous page">&larr; <code class="docutils literal notranslate"><span class="pre">swimprotocol</span></code></a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/swimprotocol.udp.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="swimprotocol.html" title="swimprotocol"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="index.html">swim-protocol 0.3.7 documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href=""><code class="docutils literal notranslate"><span class="pre">swimprotocol.udp</span></code></a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Ian Good.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>